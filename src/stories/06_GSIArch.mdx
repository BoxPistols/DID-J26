{/* GSIArch.mdx */}
import { Meta } from '@storybook/blocks'

<Meta title="Learning/06_GSIアーキテクチャ" />

# GSIアーキテクチャ

国土地理院システムの詳細なアーキテクチャ解説。

## 1. タイル座標系の詳細（XYZ）

### Z（ズームレベル）

```
Z=0: 世界全体を1タイル
Z=1: 世界全体を4タイル
Z=n: 世界全体を4^n タイル
```

### X（経度方向）

```
西（-180度） ←→ 東（+180度）
X=0 ... X=2^Z-1
```

### Y（緯度方向）

```
北（+85度）
    ↑
    Y=0
    ...
    Y=2^Z-1
    ↓
南（-85度）
```

## 2. Web Mercator（EPSG:3857）

ウェブ地図の標準投影方式。

### 特徴

1. **等角写像**: 角度関係を保持
2. **正方形タイル**: 簡単に管理可能
3. **シームレス**: タイル間に隙間がない

### 座標変換

```typescript
function lngLatToWebMercator(lng, lat) {
  const x = lng * 20037508.34 / 180.0
  const y = Math.log(Math.tan((90.0 + lat) * Math.PI / 360.0)) * 20037508.34 / Math.PI
  return { x, y }
}
```

## 3. GSI タイルサービス

| サービス | URL | ズーム | 用途 |
|---------|-----|--------|------|
| 標準地図 | std/zoom/x/y.png | 0-18 | 汎用 |
| 淡色地図 | pale/zoom/x/y.png | 0-18 | 背景 |
| 航空写真 | seamlessphoto | 0-18 | 詳細 |
| Kokuarea | kokuarea/zoom/x/y.geojson | 0-18 | 空港空域 |

## 4. ズームレベル定義

| ズーム | スケール | 用途 |
|------|---------|------|
| 0-4 | 世界～国 | 初期表示 |
| 5-8 | 都道府県～市 | 飛行計画 |
| 9-12 | 地区～ブロック | 経路詳細 |
| 13-15 | 建物～詳細 | 近接検査 |
| 16-18 | 街路～敷地 | 最大詳細 |

## 5. 属性表記要件

```html
<a href="https://maps.gsi.go.jp/development/ichiran.html">国土地理院</a>
```

これは法的要件です。

